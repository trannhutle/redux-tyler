<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.4/redux.min.js"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@16/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux-thunk/2.3.0/redux-thunk.min.js"></script>

    <script src="https://tylermcginnis.com/goals-todos-api/index.js"></script>
    <script src="https://unpkg.com/react-redux@5.0.6/dist/react-redux.min.js"></script>
  </head>
  <body>
    <div id="app"></div>
    <script type="text/javascript">
      function generateId() {
        return (
          Math.random()
            .toString(36)
            .substring(2) + new Date().getTime().toString(36)
        );
      }

      function createStore(reducer) {
        // The store shoudl have four parts
        //1. The state
        //2. Get the state
        //3. Listen to changes on the state
        //4. Update the state
        let state;
        let listeners = [];

        const getState = () => state;

        const subscribe = listener => {
          // Add a new listener
          listeners.push(listener);
          // Unsubscribe listners
          return () => {
            listeners = listeners.filter(l => l !== listener);
          };
        };

        const dispatch = action => {
          // dispatch the reducer. we will get the brand new state after invoke the reducer
          state = reducer(state, action);
          // Trigger listeners
          listeners.forEach(listener => listener());
        };

        return {
          getState,
          subscribe,
          dispatch
        };
      }

     
      // End action creator


     

      // The store contains the state of the application
      // When when we wanna change the state, we call "dispatch" function
      // (when the dispatch is called, it will go to all the reducers to invoke the
      // appropriate action) and
      // pass the "action creator " function. Next, the reducer is triggered to
      // change the state of the store
    
    </script>

    <script type="text/babel">
 

      
      
      
      const Context = React.createContext();

      // function connect(mapStateToProps) {

      //   return (Component) => {

      //     class Receiver extends React.Component{
      //       componentDidMount(){
      //         const {subscribe}  = this.props.store
      //         this.unsubscribe  = subscribe(() => this.forceUpdate())
      //       }
      //       componentWillUnmount(){
      //         this.unsubscribe()
      //       }
      //       render(){
      //         const {dispatch, getState} = this.props.store
      //         const state = getState()
      //         const stateNeeded = mapStateToProps(state)
      //         return <Component{...stateNeeded} dispatch={dispatch} />
      //       }
      //   }

      //   class ConnectedComponent extends React.Component {
      //     render(){
      //       return (
      //         <Context.Consumer>
      //           {(store) => <Receiver store={store}/>}
      //         </Context.Consumer>
      //       )
      //     }
      //   }
      //     return ConnectedComponent;
      //   };
      // }

      // Provider has responsability to grasb the Props and sticks it into
      // The context
      // class Provider extends React.Component {
      //   render() {
      //     return (
      //       <Context.Provider value={this.props.store}>
      //         {this.props.children}
      //       </Context.Provider>
      //     );
      //   }
      // }
      
      ReactDOM.render(
        <ReactRedux store={store}>
          <ConnectedApp />
        </ReactRedux>,
        document.getElementById("app")
      );
    </script>
  </body>
</html>
